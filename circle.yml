machine:
  services:
    - docker
  post:
    - docker login -u $DOCKER_USER -p $DOCKER_PASS -e $DOCKER_EMAIL $DOCKER_REGISTRY

deployment:
  production:
    branch: production
    commands:
      - docker build -t tutum.co/ashaffer/scraper-proxy:production .
      - docker push tutum.co/ashaffer/scraper-proxy
      - curl -d {} $PRODUCTION_REDEPLOY_URL
  staging:
    branch: master
    commands:
      - docker build -t tutum.co/ashaffer/scraper-proxy:staging .
      - docker push tutum.co/ashaffer/scraper-proxy
      - curl -d {} $STAGING_REDEPLOY_URL